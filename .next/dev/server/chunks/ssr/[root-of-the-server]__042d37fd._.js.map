{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Hani/ForesterSwap/pages/auth/action.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { useRouter } from \"next/router\";\r\nimport Link from \"next/link\";\r\nimport { applyActionCode, verifyPasswordResetCode, confirmPasswordReset } from \"firebase/auth\";\r\nimport { auth } from \"@/lib/firebase\";\r\n\r\nexport default function AuthAction() {\r\n  const router = useRouter();\r\n  const [mode, setMode] = useState(null);\r\n  const [actionCode, setActionCode] = useState(null);\r\n  const [status, setStatus] = useState(\"loading\"); // loading, success, error\r\n  const [message, setMessage] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    // Get the action to complete (mode) and the one-time code from the URL\r\n    const { mode: urlMode, oobCode } = router.query;\r\n\r\n    if (urlMode && oobCode) {\r\n      setMode(urlMode);\r\n      setActionCode(oobCode);\r\n      handleAction(urlMode, oobCode);\r\n    }\r\n  }, [router.query]);\r\n\r\n  async function handleAction(mode, actionCode) {\r\n    try {\r\n      switch (mode) {\r\n        case \"verifyEmail\":\r\n          await applyActionCode(auth, actionCode);\r\n          setStatus(\"success\");\r\n          setMessage(\"Your email has been verified successfully!\");\r\n          // Redirect to login after 3 seconds\r\n          setTimeout(() => router.push(\"/login\"), 3000);\r\n          break;\r\n\r\n        case \"resetPassword\":\r\n          // Handle password reset (you can expand this later)\r\n          setStatus(\"success\");\r\n          setMessage(\"Password reset link is valid. Redirecting...\");\r\n          setTimeout(() => router.push(`/reset-password?oobCode=${actionCode}`), 2000);\r\n          break;\r\n\r\n        case \"recoverEmail\":\r\n          await applyActionCode(auth, actionCode);\r\n          setStatus(\"success\");\r\n          setMessage(\"Your email has been recovered successfully!\");\r\n          break;\r\n\r\n        default:\r\n          setStatus(\"error\");\r\n          setError(\"Invalid action mode\");\r\n      }\r\n    } catch (err) {\r\n      setStatus(\"error\");\r\n      if (err.code === \"auth/expired-action-code\") {\r\n        setError(\"This link has expired. Please request a new verification email.\");\r\n      } else if (err.code === \"auth/invalid-action-code\") {\r\n        setError(\"This link is invalid or has already been used.\");\r\n      } else {\r\n        setError(err.message || \"An error occurred. Please try again.\");\r\n      }\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center gradient-bg py-12\">\r\n      <div className=\"bg-[#2a2a2a] p-8 rounded-2xl shadow-xl w-full max-w-md\">\r\n        <div className=\"text-center mb-8\">\r\n          <Link href=\"/\" className=\"inline-block mb-4\">\r\n            <h1 className=\"text-3xl font-bold gradient-text\">ðŸŒ² ForesterSwap</h1>\r\n          </Link>\r\n          <h2 className=\"text-2xl font-bold text-gray-100 mb-2\">\r\n            {mode === \"verifyEmail\" && \"Email Verification\"}\r\n            {mode === \"resetPassword\" && \"Reset Password\"}\r\n            {mode === \"recoverEmail\" && \"Recover Email\"}\r\n            {!mode && \"Processing...\"}\r\n          </h2>\r\n        </div>\r\n\r\n        <div className=\"space-y-4\">\r\n          {status === \"loading\" && (\r\n            <div className=\"text-center py-8\">\r\n              <div className=\"inline-block animate-spin rounded-full h-12 w-12 border-4 border-primary-500 border-t-transparent\"></div>\r\n              <p className=\"text-gray-400 mt-4\">Processing your request...</p>\r\n            </div>\r\n          )}\r\n\r\n          {status === \"success\" && (\r\n            <div className=\"bg-green-900/30 border border-green-700 text-green-300 px-4 py-4 rounded-lg\">\r\n              <div className=\"flex items-center mb-2\">\r\n                <svg className=\"w-6 h-6 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\r\n                </svg>\r\n                <h3 className=\"font-semibold\">Success!</h3>\r\n              </div>\r\n              <p className=\"text-sm\">{message}</p>\r\n            </div>\r\n          )}\r\n\r\n          {status === \"error\" && (\r\n            <div className=\"bg-red-900/30 border border-red-700 text-red-300 px-4 py-4 rounded-lg\">\r\n              <div className=\"flex items-center mb-2\">\r\n                <svg className=\"w-6 h-6 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                </svg>\r\n                <h3 className=\"font-semibold\">Error</h3>\r\n              </div>\r\n              <p className=\"text-sm\">{error}</p>\r\n            </div>\r\n          )}\r\n\r\n          {status === \"success\" && mode === \"verifyEmail\" && (\r\n            <div className=\"text-center pt-4\">\r\n              <p className=\"text-gray-400 text-sm mb-4\">Redirecting you to login...</p>\r\n              <Link href=\"/login\" className=\"btn-primary inline-block\">\r\n                Go to Login\r\n              </Link>\r\n            </div>\r\n          )}\r\n\r\n          {status === \"error\" && (\r\n            <div className=\"text-center pt-4\">\r\n              <Link href=\"/verify-email\" className=\"btn-primary inline-block mb-2\">\r\n                Request New Verification Email\r\n              </Link>\r\n              <br />\r\n              <Link href=\"/login\" className=\"text-gray-400 hover:text-gray-200 text-sm\">\r\n                Back to Login\r\n              </Link>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AAEe,SAAS;IACtB,MAAM,SAAS,IAAA,oIAAS;IACxB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,+GAAQ,EAAC;IACjC,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,+GAAQ,EAAC;IAC7C,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+GAAQ,EAAC,YAAY,0BAA0B;IAC3E,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+GAAQ,EAAC;IAEnC,IAAA,gHAAS,EAAC;QACR,uEAAuE;QACvE,MAAM,EAAE,MAAM,OAAO,EAAE,OAAO,EAAE,GAAG,OAAO,KAAK;QAE/C,IAAI,WAAW,SAAS;YACtB,QAAQ;YACR,cAAc;YACd,aAAa,SAAS;QACxB;IACF,GAAG;QAAC,OAAO,KAAK;KAAC;IAEjB,eAAe,aAAa,IAAI,EAAE,UAAU;QAC1C,IAAI;YACF,OAAQ;gBACN,KAAK;oBACH,MAAM,IAAA,mJAAe,EAAC,gHAAI,EAAE;oBAC5B,UAAU;oBACV,WAAW;oBACX,oCAAoC;oBACpC,WAAW,IAAM,OAAO,IAAI,CAAC,WAAW;oBACxC;gBAEF,KAAK;oBACH,oDAAoD;oBACpD,UAAU;oBACV,WAAW;oBACX,WAAW,IAAM,OAAO,IAAI,CAAC,CAAC,wBAAwB,EAAE,YAAY,GAAG;oBACvE;gBAEF,KAAK;oBACH,MAAM,IAAA,mJAAe,EAAC,gHAAI,EAAE;oBAC5B,UAAU;oBACV,WAAW;oBACX;gBAEF;oBACE,UAAU;oBACV,SAAS;YACb;QACF,EAAE,OAAO,KAAK;YACZ,UAAU;YACV,IAAI,IAAI,IAAI,KAAK,4BAA4B;gBAC3C,SAAS;YACX,OAAO,IAAI,IAAI,IAAI,KAAK,4BAA4B;gBAClD,SAAS;YACX,OAAO;gBACL,SAAS,IAAI,OAAO,IAAI;YAC1B;QACF;IACF;IAEA,qBACE,qKAAC;QAAI,WAAU;kBACb,cAAA,qKAAC;YAAI,WAAU;;8BACb,qKAAC;oBAAI,WAAU;;sCACb,qKAAC,gIAAI;4BAAC,MAAK;4BAAI,WAAU;sCACvB,cAAA,qKAAC;gCAAG,WAAU;0CAAmC;;;;;;;;;;;sCAEnD,qKAAC;4BAAG,WAAU;;gCACX,SAAS,iBAAiB;gCAC1B,SAAS,mBAAmB;gCAC5B,SAAS,kBAAkB;gCAC3B,CAAC,QAAQ;;;;;;;;;;;;;8BAId,qKAAC;oBAAI,WAAU;;wBACZ,WAAW,2BACV,qKAAC;4BAAI,WAAU;;8CACb,qKAAC;oCAAI,WAAU;;;;;;8CACf,qKAAC;oCAAE,WAAU;8CAAqB;;;;;;;;;;;;wBAIrC,WAAW,2BACV,qKAAC;4BAAI,WAAU;;8CACb,qKAAC;oCAAI,WAAU;;sDACb,qKAAC;4CAAI,WAAU;4CAAe,MAAK;4CAAO,QAAO;4CAAe,SAAQ;sDACtE,cAAA,qKAAC;gDAAK,eAAc;gDAAQ,gBAAe;gDAAQ,aAAa;gDAAG,GAAE;;;;;;;;;;;sDAEvE,qKAAC;4CAAG,WAAU;sDAAgB;;;;;;;;;;;;8CAEhC,qKAAC;oCAAE,WAAU;8CAAW;;;;;;;;;;;;wBAI3B,WAAW,yBACV,qKAAC;4BAAI,WAAU;;8CACb,qKAAC;oCAAI,WAAU;;sDACb,qKAAC;4CAAI,WAAU;4CAAe,MAAK;4CAAO,QAAO;4CAAe,SAAQ;sDACtE,cAAA,qKAAC;gDAAK,eAAc;gDAAQ,gBAAe;gDAAQ,aAAa;gDAAG,GAAE;;;;;;;;;;;sDAEvE,qKAAC;4CAAG,WAAU;sDAAgB;;;;;;;;;;;;8CAEhC,qKAAC;oCAAE,WAAU;8CAAW;;;;;;;;;;;;wBAI3B,WAAW,aAAa,SAAS,+BAChC,qKAAC;4BAAI,WAAU;;8CACb,qKAAC;oCAAE,WAAU;8CAA6B;;;;;;8CAC1C,qKAAC,gIAAI;oCAAC,MAAK;oCAAS,WAAU;8CAA2B;;;;;;;;;;;;wBAM5D,WAAW,yBACV,qKAAC;4BAAI,WAAU;;8CACb,qKAAC,gIAAI;oCAAC,MAAK;oCAAgB,WAAU;8CAAgC;;;;;;8CAGrE,qKAAC;;;;;8CACD,qKAAC,gIAAI;oCAAC,MAAK;oCAAS,WAAU;8CAA4C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASxF"}}]
}